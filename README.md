# IBM-Watson-GiftAdvisor
Think of this application like a knowledgeable personal shopper. You can tell it a bit about who you’re shopping for, what some of their interests are then the bot will come up with great gift ideas. It’s fast, easy and scalable.

![Demo](readme_images/hi.gif)


## Prerequisites
1. Node 8.x
1. npm package manager
1. Express
1. Watson Developer Cloud
1. Twilio
1. Cloud Foundry command-line client - 
   Note: Ensure that your Cloud Foundry version is up to date
1. ngrok


## Local Deployment

### Setting up the Conversation Service

1. At the command line, go to the local project directory.

1. Connect to Bluemix with the Cloud Foundry command-line tool. 

   ```bash
   cf login
   ```

1. Create an instance of the Conversation service in Bluemix. 

   ```bash
   cf create-service conversation free my-service
   ```


### Importing the Conversation workspace

1. In your browser, navigate to your Bluemix console (https://console.ng.bluemix.net/dashboard/services).

1. From the **All Items** tab, click the newly created Conversation service in the **Services** list.

1. On the Service Details page, click **Launch tool**.

1. Click the **Import workspace** icon in the Conversation service tool. Specify the location of the workspace JSON file in your local copy of the app project.

1. Select **Everything (Intents, Entities, and Dialog)** and then click **Import**. The dashboard workspace is created.


### Configuring the app environment

1. Create a service key in the format `cf create-service-key <service_instance> <service_key>`. For example:

   ```bash
   cf create-service-key my-conversation-service myKey
   ```

1. Retrieve the credentials from the service key using the command `cf service-key <service_instance> <service_key>`. For example:

   ```bash
   cf service-key my-conversation-service myKey
   ```

   The output from this command is a JSON object, as in this example:

   ```JSON
   {
	"password": "87iT7aqpvU7l",
	"url": "https://gateway.watsonplatform.net/conversation/api",
	"username": "ca2905e6-7b5d-4408-9192-e4d54d83e604"
   }
   ```

1. Paste  the `password` and `username` values (without quotation marks) from the JSON into the `CONVERSATION_PASSWORD` and `CONVERSATION_USERNAME` variables in the `index.js` file. For example:

   ```
   CONVERSATION_USERNAME=ca2905e6-7b5d-4408-9192-e4d54d83e604
   CONVERSATION_PASSWORD=87iT7aqpvU7l
   ```

1. In your Bluemix console, open the Conversation service instance where you imported the workspace.

1. Click the menu icon in the upper-right corner of the workspace tile, and then select **View details**.

1. Copy the workspace ID to the clipboard and on the local system, paste the workspace ID into the WORKSPACE_ID variable in the `index.js` file. 

### Build a secure tunnel to localhost via ngork

1. After installing ngork from its website, put the executable file on the desktop so that it can be used from the command line. Start the web server via ngrok on port 3000 (NodeJs application will be running on the port 3000):

   ```bash
   ngrok http 3000
   ```

### Installing and starting the app

1. Install the app package into the local Node.js runtime environment:

   ```bash
   npm install
   ```

1. Start the app:

   ```bash
   node index.js
   ```

## Testing the app

After your app is installed and running, experiment with it to see how it responds.

1. Call any of the temporary links generated by ngrok from your web browser to see if the request goes through.

2. Now follow the demo video.


## Deploying to Bluemix

You can use Cloud Foundry to deploy your local version of the app to Bluemix.

1. In the project root directory, open the `manifest.yml` file:

  * In the `applications` section of the `manifest.yml` file, change the `name` value to a unique name for your version of the demo app.
  * In the `services` section, specify the name of the Conversation service instance you created for the demo app. If you do not remember the service name, use the `cf services` command to list all services you have created.

   The following example shows a modified `manifest.yml` file:

   ```yml
   declared-services:
   conversation-service:
      label: conversation
      plan: free
   applications:
      name: IBM-Waston-GiftAdvisor-test1
      command: npm start
      path: .
      memory: 256M
      instances: 1
      services:
      - my-conversation-service
   env:
      NPM_CONFIG_PRODUCTION: false
   ```

1. Push the app to Bluemix:

   ```bash
   cf push
   ```

1. Access your app on Bluemix at the URL specified in the command output.


## Troubleshooting

1. If you encounter a problem, you can check the logs for more information. To see the logs, run the `cf logs` command:

   ```none
   cf logs <application-name> --recent
   ```

## License

1. This sample code is licensed under Apache 2.0.
